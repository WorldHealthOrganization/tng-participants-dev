name: Export Secrets to Test1

on:
  workflow_dispatch:

jobs:
  export-secrets:
    runs-on: ubuntu-latest
    steps:
      - name: Export Secrets as Base64 test
        run: |
          mkdir -p secrets/test1
          echo '${{ toJson(secrets) }}' > secrets.json
          cat secrets.json | jq -r 'keys[] as $k | "\($k):\(.[$k])"' | while IFS=: read -r name value; do
            # Encode each secret value in base64 and save to file
            echo -n "$value" | base64 > "secrets/test1/${name}.b64"
          done
          echo "List created files"
          ls -la secrets/test1

      - name: Upload secrets as artifact
        uses: actions/upload-artifact@v4
        with:
          name: secrets-test1
          path: secrets/test1
